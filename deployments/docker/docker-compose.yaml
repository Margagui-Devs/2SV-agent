version: "3.9"
x-common-variables: &common-variables
  # Add variables here to add them to all agents
  AGENT_HUB_KEY: "xxxxx" # The access key linked to your account in 2SV Hub.
  AGENT_HUB_PRIVATE_KEY: "xxxxx" # The secret access key linked to your account in 2SV Hub.
  # find full list of environment variables here: https://github.com/margagui/2sv-agent#override-with-environment-variables
services:
  2SV-agent1:
    image: "margagui/2sv-agent:latest"
    ports:
      - "8081:80"
    environment:
      <<: *common-variables
      AGENT_NAME: agent1
      AGENT_CAPTURE_IPCAMERA_RTSP: rtsp://username:password@x.x.x.x/Streaming/Channels/101 # Hikvision camera RTSP url example
      AGENT_KEY: "1"
  2SV-agent2:
    image: "margagui/2sv-agent:latest"
    ports:
      - "8082:80"
    environment:
      <<: *common-variables
      AGENT_NAME: agent2
      AGENT_CAPTURE_IPCAMERA_RTSP: rtsp://username:password@x.x.x.x/channel1 # Linksys camera RTSP url example
      AGENT_KEY: "2"
  2SV-agent3:
    image: "margagui/2sv-agent:latest"
    ports:
      - "8083:80"
    environment:
      <<: *common-variables
      AGENT_NAME: agent3
      AGENT_CAPTURE_IPCAMERA_RTSP: rtsp://username:password@x.x.x.x/cam/realmonitor?channel=1&subtype=1 # Dahua camera RTSP url example
      AGENT_KEY: "3"
networks:
  default:
    name: cluster-net
    external: true
